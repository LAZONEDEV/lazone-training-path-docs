"use strict";(self.webpackChunklazone_learning_path=self.webpackChunklazone_learning_path||[]).push([[285],{3905:(e,n,t)=>{t.d(n,{Zo:()=>s,kt:()=>k});var r=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,l=function(e,n){if(null==e)return{};var t,r,l={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var p=r.createContext({}),u=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},s=function(e){var n=u(e.components);return r.createElement(p.Provider,{value:n},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,l=e.mdxType,a=e.originalType,p=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),c=u(t),m=l,k=c["".concat(p,".").concat(m)]||c[m]||d[m]||a;return t?r.createElement(k,o(o({ref:n},s),{},{components:t})):r.createElement(k,o({ref:n},s))}));function k(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var a=t.length,o=new Array(a);o[0]=m;var i={};for(var p in n)hasOwnProperty.call(n,p)&&(i[p]=n[p]);i.originalType=e,i[c]="string"==typeof e?e:l,o[1]=i;for(var u=2;u<a;u++)o[u]=t[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},6066:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>u});var r=t(7462),l=(t(7294),t(3905));const a={},o="Mise en place d'un environnement de d\xe9veloppement avec Docker",i={unversionedId:"fullstack-learning-path/module-1/environnement-docker",id:"fullstack-learning-path/module-1/environnement-docker",title:"Mise en place d'un environnement de d\xe9veloppement avec Docker",description:"Cette section couvre la configuration et l'utilisation de Docker pour cr\xe9er un environnement de d\xe9veloppement robuste et reproductible.",source:"@site/docs/fullstack-learning-path/module-1/02-environnement-docker.md",sourceDirName:"fullstack-learning-path/module-1",slug:"/fullstack-learning-path/module-1/environnement-docker",permalink:"/lazone-training-path-docs/docs/next/fullstack-learning-path/module-1/environnement-docker",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/fullstack-learning-path/module-1/02-environnement-docker.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Introduction \xe0 l'architecture moderne des applications JavaScript",permalink:"/lazone-training-path-docs/docs/next/fullstack-learning-path/module-1/intro-architecture-moderne"},next:{title:"Les bases des monorepos: avantages et cas d'utilisation",permalink:"/lazone-training-path-docs/docs/next/fullstack-learning-path/module-1/monorepos-basics"}},p={},u=[{value:"Objectifs d&#39;apprentissage",id:"objectifs-dapprentissage",level:2},{value:"Plan du cours",id:"plan-du-cours",level:2},{value:"Concepts cl\xe9s",id:"concepts-cl\xe9s",level:2},{value:"Dockerfile (dev) pour Next.js",id:"dockerfile-dev-pour-nextjs",level:2},{value:"docker-compose pour le dev local",id:"docker-compose-pour-le-dev-local",level:2},{value:"Variables d\u2019environnement",id:"variables-denvironnement",level:2},{value:"Bonnes pratiques",id:"bonnes-pratiques",level:2},{value:"Pi\xe8ges courants",id:"pi\xe8ges-courants",level:2},{value:"Pratique",id:"pratique",level:2},{value:"Contr\xf4le",id:"contr\xf4le",level:2}],s={toc:u},c="wrapper";function d(e){let{components:n,...t}=e;return(0,l.kt)(c,(0,r.Z)({},s,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"mise-en-place-dun-environnement-de-d\xe9veloppement-avec-docker"},"Mise en place d'un environnement de d\xe9veloppement avec Docker"),(0,l.kt)("p",null,"Cette section couvre la configuration et l'utilisation de Docker pour cr\xe9er un environnement de d\xe9veloppement robuste et reproductible."),(0,l.kt)("h2",{id:"objectifs-dapprentissage"},"Objectifs d'apprentissage"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Comprendre les concepts fondamentaux de Docker"),(0,l.kt)("li",{parentName:"ul"},"Mettre en place un environnement de d\xe9veloppement conteneuris\xe9"),(0,l.kt)("li",{parentName:"ul"},"Ma\xeetriser les bonnes pratiques Docker pour le d\xe9veloppement")),(0,l.kt)("h2",{id:"plan-du-cours"},"Plan du cours"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Introduction \xe0 Docker"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Concepts de base de la conteneurisation"),(0,l.kt)("li",{parentName:"ul"},"Architecture Docker"),(0,l.kt)("li",{parentName:"ul"},"Installation et configuration"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Configuration de l'environnement"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Cr\xe9ation de Dockerfiles"),(0,l.kt)("li",{parentName:"ul"},"Docker Compose pour les applications multi-conteneurs"),(0,l.kt)("li",{parentName:"ul"},"Gestion des volumes et des r\xe9seaux"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Bonnes pratiques"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Optimisation des images"),(0,l.kt)("li",{parentName:"ul"},"S\xe9curit\xe9 des conteneurs"),(0,l.kt)("li",{parentName:"ul"},"Gestion des logs et monitoring"),(0,l.kt)("li",{parentName:"ul"},"CI/CD avec Docker")))),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"concepts-cl\xe9s"},"Concepts cl\xe9s"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Image: mod\xe8le immuable (layers). Conteneur: instance en ex\xe9cution d\u2019une image."),(0,l.kt)("li",{parentName:"ul"},"Layers: chaque instruction Dockerfile cr\xe9e une couche; mutualisation via cache."),(0,l.kt)("li",{parentName:"ul"},"Registry: d\xe9p\xf4t d\u2019images (Docker Hub, GHCR).")),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"dockerfile-dev-pour-nextjs"},"Dockerfile (dev) pour Next.js"),(0,l.kt)("p",null,"Objectif: environnement de dev avec hot\u2011reload. On monte le code en volume et on installe les d\xe9pendances dans le conteneur."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-Dockerfile"},'# Dockerfile.dev\nFROM node:20-alpine\n\n# Cr\xe9er un utilisateur non-root pour la s\xe9curit\xe9\nRUN addgroup -S app && adduser -S app -G app\nUSER app\n\nWORKDIR /app\n\n# Copie des manifests pour profiter du cache d\u2019installation\nCOPY --chown=app:app package.json package-lock.json* pnpm-lock.yaml* yarn.lock* ./\n\n# Installer pnpm si besoin, sinon utiliser npm/yarn\nRUN corepack enable || true\n\n# Installer les d\xe9pendances (si lock pr\xe9sent)\nRUN if [ -f pnpm-lock.yaml ]; then pnpm install --frozen-lockfile; \\\n    elif [ -f yarn.lock ]; then yarn install --frozen-lockfile; \\\n    elif [ -f package-lock.json ]; then npm ci; \\\n    else npm install; fi\n\n# Exposer le port dev Next\nEXPOSE 3000\n\n# D\xe9marrer en mode dev (le code sera mont\xe9 en volume depuis l\u2019h\xf4te)\nCMD ["npm","run","dev"]\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},".dockerignore")," minimal:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"node_modules\n.next\ndist\n.git\n.DS_Store\n")),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"docker-compose-pour-le-dev-local"},"docker-compose pour le dev local"),(0,l.kt)("p",null,"Permet de monter le dossier du projet et de b\xe9n\xe9ficier du hot\u2011reload Next.js."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},'# docker-compose.dev.yml\nversion: "3.9"\nservices:\n  web:\n    build:\n      context: .\n      dockerfile: Dockerfile.dev\n    ports:\n      - "3000:3000"\n    environment:\n      - NODE_ENV=development\n      - PORT=3000\n    # Monter le code depuis l\u2019h\xf4te (hot\u2011reload)\n    volumes:\n      - ./:/app\n      - /app/node_modules\n    # Optionnel: variables depuis un fichier\n    env_file:\n      - .env.local\n')),(0,l.kt)("p",null,"Lancer:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose -f docker-compose.dev.yml up --build\n")),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"variables-denvironnement"},"Variables d\u2019environnement"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Next.js lit ",(0,l.kt)("inlineCode",{parentName:"li"},".env.local")," en dev; ne pas commiter les secrets."),(0,l.kt)("li",{parentName:"ul"},"En conteneur, utiliser ",(0,l.kt)("inlineCode",{parentName:"li"},"env_file")," ou ",(0,l.kt)("inlineCode",{parentName:"li"},"environment")," dans Compose."),(0,l.kt)("li",{parentName:"ul"},"Pr\xe9fixer en ",(0,l.kt)("inlineCode",{parentName:"li"},"NEXT_PUBLIC_")," uniquement ce qui peut \xeatre expos\xe9 au navigateur.")),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"bonnes-pratiques"},"Bonnes pratiques"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Utilisateur non\u2011root, ",(0,l.kt)("inlineCode",{parentName:"li"},"WORKDIR")," d\xe9di\xe9."),(0,l.kt)("li",{parentName:"ul"},"Ignorer ",(0,l.kt)("inlineCode",{parentName:"li"},"node_modules")," dans ",(0,l.kt)("inlineCode",{parentName:"li"},".dockerignore")," et cr\xe9er un volume anonyme ",(0,l.kt)("inlineCode",{parentName:"li"},"/app/node_modules")," pour \xe9viter la collision h\xf4te."),(0,l.kt)("li",{parentName:"ul"},"Cibler des images petites (",(0,l.kt)("inlineCode",{parentName:"li"},"alpine"),") pour le dev et la CI."),(0,l.kt)("li",{parentName:"ul"},"S\xe9parer Dockerfile dev et prod (multi\u2011stage pour prod)."),(0,l.kt)("li",{parentName:"ul"},"Logger sur stdout/stderr; confier la rotation \xe0 l\u2019orchestrateur.")),(0,l.kt)("h2",{id:"pi\xe8ges-courants"},"Pi\xe8ges courants"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Monter ",(0,l.kt)("inlineCode",{parentName:"li"},"node_modules")," depuis l\u2019h\xf4te sur des OS diff\xe9rents (incompatibilit\xe9s). Pr\xe9f\xe9rer le volume anonyme dans le conteneur."),(0,l.kt)("li",{parentName:"ul"},"Ne pas fixer le port/host Next (utiliser ",(0,l.kt)("inlineCode",{parentName:"li"},"-p 3000:3000"),")."),(0,l.kt)("li",{parentName:"ul"},"Oublier ",(0,l.kt)("inlineCode",{parentName:"li"},".dockerignore")," \u2192 images lourdes et builds lents.")),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"pratique"},"Pratique"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Cr\xe9er ",(0,l.kt)("inlineCode",{parentName:"li"},"Dockerfile.dev")," et ",(0,l.kt)("inlineCode",{parentName:"li"},"docker-compose.dev.yml")," pour lancer une app Next.js en hot\u2011reload."),(0,l.kt)("li",{parentName:"ul"},"Tester une variable ",(0,l.kt)("inlineCode",{parentName:"li"},"NEXT_PUBLIC_API_URL")," lue c\xf4t\xe9 client et c\xf4t\xe9 serveur.")),(0,l.kt)("h2",{id:"contr\xf4le"},"Contr\xf4le"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Expliquer la diff\xe9rence entre ",(0,l.kt)("inlineCode",{parentName:"li"},".env.local")," et les variables pass\xe9es via Compose."),(0,l.kt)("li",{parentName:"ul"},"Lister 3 optimisations pour r\xe9duire la taille d\u2019une image et acc\xe9l\xe9rer le build.")))}d.isMDXComponent=!0}}]);